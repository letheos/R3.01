-- Structure for view `infocandidate`
--
DROP TABLE IF EXISTS `infocandidate`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `infocandidate` AS
SELECT
    `candidate`.`idCandidate` AS `idCandidate`,
    `candidate`.`INE` AS `INE`,
    `candidate`.`name` AS `name`,
    `candidate`.`firstName` AS `firstName`,
    `candidate`.`nameParcours` AS `nameParcours`,
    `formation`.`nameFormation` AS `nameFormation`,
    `candidate`.`yearOfFormation` AS `yearOfFormation`,
    `candidate`.`isInActiveSearch` AS `isInActiveSearch`,
    `candidate`.`permisB` AS `permisB`,
    `candidate`.`typeCompanySearch` AS `typeCompanySearch`,
    `candidate`.`cv` AS `cv`,
    `candidate`.`remarks` AS `remarks`,
    GROUP_CONCAT(DISTINCT `candidateaddress`.`idAddr` SEPARATOR ',') AS `AddressesIDs`,
    GROUP_CONCAT(DISTINCT `candidatezone`.`idZone` SEPARATOR ',') AS `ZonesRechercheIDs`
FROM (
    (
        (
            (
                `candidate`
                LEFT JOIN `candidateaddress` ON (`candidate`.`idCandidate` = `candidateaddress`.`idCandidate`)
            )
            LEFT JOIN `candidatezone` ON (`candidate`.`idCandidate` = `candidatezone`.`idCandidate`)
        )
        LEFT JOIN `parcours` ON (`candidate`.`nameParcours` = `parcours`.`nameParcours`)
    )
    LEFT JOIN `formation` ON (`parcours`.`nameFormationParcours` = `formation`.`nameFormation`)
)
GROUP BY `candidate`.`idCandidate`;
